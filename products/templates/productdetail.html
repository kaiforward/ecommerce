{% extends "base.html" %}

{% load static %}
{% block title %}{{ product.name }}{% endblock %}
{% block content %}

<div class="prodrowcolcontainer">
	<div class="productbox">
		<div id="carouselIndicators" class="carousel mycarousel slide" data-ride="carousel" style="width:100%;">
			<ol class="carousel-indicators">
				<li data-target="#carouselIndicators" data-slide-to="0" class="active"></li>
				<li data-target="#carouselIndicators" data-slide-to="1"></li>
				<li data-target="#carouselIndicators" data-slide-to="2"></li>
			</ol>
			<div class="carousel-inner" role="listbox">
				<!-- using FOO_set allows objects to access related foreign key objects -->
				{% for photo in product.photo_set.all %}
					<!-- for the carousel to work we use if statement to add active class to first item only -->
					<div class="carousel-item {% if forloop.first %} active{% endif %}">
				  		<img class="d-block productfocusimg" src="/media/{{ photo.image }}">
					</div>		
				{% endfor %}
			</div>
			<a class="carousel-control-prev color" href="#carouselIndicators" role="button" data-slide="prev">
				<i class="fa fa-chevron-left"></i>
			</a>
			<a class="carousel-control-next color" href="#carouselIndicators" role="button" data-slide="next">
				<i class="fa fa-chevron-right"></i>
			</a>
		</div>
	</div>	
	<div class="productbox">
		<div class="productdetailinfo">
			<h3>{{ product.name }}</h3>
			<!-- use safe tag for description as admin users only will input product descriptions. Allows html rendering from tinyMCE -->
			<div>
				{{ product.description|safe }}
			</div>
			<div class="infowrap">
				<p class="productinfobox">Price:</p>
				<p class="productinfobox">Â£{{ product.price }}</p>
			</div>
			<div class="infowrap">
				<p class="productinfobox">Stock Available:</p>
				<p class="productinfobox">{{ product.stock }}</p>
			</div>	

					
			{% if product.variant_two %}
				<div class="infowrap">
					{{ product.variant_two }}				
					<select class="myselect" name="variantlist" form="form">
						<!-- using FOO_set allows objects to access related foreign key objects using name or related name -->
						{% for attribute in product.variant_two.productattribute_set.all %}
							<option value="{{ attribute.attribute }}">{{ attribute.attribute }}</option>
			  			{% endfor %}
					</select>
				</div>			
			{% endif %}

			{% if product.variant_three %}
				<div class="infowrap">
					{{ product.variant_three }}				
					<select class="myselect" name="variantlist" form="form">
						<!-- using FOO_set allows objects to access related foreign key objects using name or related name -->
						{% for attribute in product.variant_three.productattribute_set.all %}
							<option value="{{ attribute.attribute }}">{{ attribute.attribute }}</option>
			  			{% endfor %}
					</select>
					</div>		
			{% endif %}		
			<form class="myform" action="{% url 'cart_add' product.pk %}" method="post">

				<div class="cartrowcol">
					{% if product.variant %}
					<p> {{ product.variant }} </p>
					{{ cart_product_form.variant }}
					{% endif %}
				</div>
				<div class="cartrowcol">
					<p>Quantity</p>
					{{ cart_product_form.quantity }}
					{{ variant }}
				</div>
				<div class="cartrowcol">
				<p style="height: 28px;"></p>
				{% csrf_token %}
				<input type="submit" name="" value="Add To Cart">
				</div>
			</form>
		</div>
	</div>
</div>

{% endblock %}